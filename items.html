<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
    
    <title>items omeka </title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <!-- <style>
        .section{
            margin: 30px;
        }
        .items{
            color: rgb(red, green, blue);
        }
        .items:hover{
            text-decoration: underline;
            cursor: pointer;
        }

    </style> -->
</head>
<body>
    <div class="dropdown">
        <button
          class="btn btn-secondary dropdown-toggle"
          type="button"
          id="dropdownMenuButton"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false"
        >
          Afficher
        </button>
        <div
          class="dropdown-menu"
          id="filter"
          aria-labelledby="dropdownMenuButton"
        >
      </div>
      </div>
      <div class="container">
        <div id="items" class="row"></div>
      </div>
    </body>

            <script>
                showItems();
                function showItems(){
                    items = new Array();
                    d3.json("https://polemika.univ-paris8.fr/omk/api/items?/item_sets_id=2", function(data)
                    {
                        console.log(data);
                        data.array.forEach((d) => {
                            if (d["dcterms:subject"]){
                                if (items.indexOf(d["dcterms:subject"][0]["@value"])<0){
                                    items.push(d["dcterms:subject"][0]["@value"]);
                                    
                                }
                            }
                            
                        });
                        items.forEach((i) =>{
                            d3.select("#filter")
                            .append("a")
                            .text(i)
                            .attr("class", "dropdown-item")
                            .on("click", function(){
                                showFilterItems(i)
                            })
                        })
                    })
                }

                    function showFilterItems(items){
                        console.log(items)
                        document.getElementById("items").innerHTML =''
                        d3.json("https://polemika.univ-paris8.fr/omk/api/items?/item_sets_id=2").then(function(data)
                        {
                            data.forEach((d) => {
                                if (d["dcterms:subject"][0]["@value"] == items){
                                    d3.select("#items")
                                    .append("div")
                                    .html(
                                        "Identifiant : "+
                                        d["o:id"]+
                                        " Titre : "+
                                        d["o:title"]+
                                        " <img src ='"+
                                        d["o:media"][0]["@id"]+
                                        "'>"
                                    )
                                    .attr("class", "card col-md-3")
                                }
                            })
                        })
                    }
               

            </script>
    

</html>